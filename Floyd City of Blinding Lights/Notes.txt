Solved most of the test cases, but a few of them return timeout errors.

I think I've exhausted my own ideas on how to optimize this more, so I'll have to read up 
on how to do that.